<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é£²é£Ÿåº—å·¥äº‹è¦‹ç©ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ</title>
    <style>
        :root {
            --primary-color: #2c5eff;
            --primary-light: #e8efff;
            --primary-dark: #1e45cc;
            --text-color: #333;
            --light-bg: #f8f9ff;
            --border-color: #ddd;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: "Yu Gothic", "æ¸¸ã‚´ã‚·ãƒƒã‚¯", YuGothic, "æ¸¸ã‚´ã‚·ãƒƒã‚¯ä½“", sans-serif;
        }
        
        body {
            background-color: #f9f9f9;
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .chat-container {
            max-width: 400px;
            margin: 20px auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 600px;
        }
        
        .chat-header {
            background: var(--primary-color);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chat-header .chat-icon {
            margin-right: 8px;
            font-size: 20px;
        }
        
        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: var(--light-bg);
        }
        
        .message {
            margin-bottom: 15px;
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 20px;
            position: relative;
            clear: both;
            word-wrap: break-word;
        }
        
        .bot {
            background: white;
            color: var(--text-color);
            border: 1px solid var(--border-color);
            float: left;
            border-bottom-left-radius: 5px;
        }
        
        .user {
            background: var(--primary-color);
            color: white;
            float: right;
            border-bottom-right-radius: 5px;
        }
        
        .chat-input {
            display: flex;
            padding: 10px;
            border-top: 1px solid var(--border-color);
            background: white;
        }
        
        .chat-input input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: 30px;
            outline: none;
            font-size: 14px;
        }
        
        .chat-input input:focus {
            border-color: var(--primary-color);
        }
        
        .chat-input button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            margin-left: 10px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .chat-input button:hover {
            background: var(--primary-dark);
        }
        
        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .option-button {
            background: white;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        .option-button:hover {
            background: var(--primary-light);
        }
        
        .estimate-result {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            max-width: 90%;
            float: left;
            clear: both;
        }
        
        .estimate-title {
            color: var(--primary-color);
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 15px;
        }
        
        .estimate-price {
            font-size: 22px;
            font-weight: bold;
            color: var(--primary-color);
            margin: 5px 0;
        }
        
        .estimate-detail {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            font-size: 13px;
        }
        
        .estimate-note {
            font-size: 12px;
            color: #666;
            margin-top: 10px;
        }
        
        .restart-button {
            background: var(--light-bg);
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            margin-top: 10px;
            display: inline-block;
        }
        
        .restart-button:hover {
            background: var(--primary-light);
        }
        
        .clearfix::after {
            content: "";
            clear: both;
            display: table;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <span class="chat-icon">ğŸ’¬</span>
            <span>é£²é£Ÿåº—å·¥äº‹è¦‹ç©ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</span>
        </div>
        <div class="chat-messages" id="chat-messages">
            <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯JSã§å‹•çš„ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
        </div>
        <div class="chat-input">
            <input type="text" id="user-input" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..." disabled>
            <button id="send-button" disabled>é€ä¿¡</button>
        </div>
    </div>

    <script>
        // åŸºæœ¬å˜ä¾¡è¨­å®šï¼ˆ1åªã‚ãŸã‚Šã€ä¸‡å††ï¼‰
        const baseCosts = {
            'urban': { 'new': 90, 'renovation': 70, 'tenant': 40 },
            'major-city': { 'new': 80, 'renovation': 60, 'tenant': 35 },
            'regional-city': { 'new': 70, 'renovation': 50, 'tenant': 30 },
            'suburban': { 'new': 60, 'renovation': 45, 'tenant': 25 }
        };
        
        // æ¥­æ…‹ä¿‚æ•°
        const businessTypeFactors = {
            'restaurant': 1.2,
            'cafe': 1.0,
            'bar': 1.1,
            'fastfood': 0.9,
            'takeout': 0.8
        };
        
        // å¨æˆ¿è¦æ¨¡ä¿‚æ•°
        const kitchenScaleFactors = {
            'full': 1.3,
            'semi': 1.2,
            'simple': 1.0,
            'drink': 0.7
        };
        
        // å†…è£…ã‚°ãƒ¬ãƒ¼ãƒ‰ä¿‚æ•°
        const interiorGradeFactors = {
            'standard': 1.0,
            'middle': 1.3,
            'high': 1.7
        };
        
        // å·¥æœŸä¿‚æ•°
        const constructionPeriodFactors = {
            'normal': 1.0,
            'express': 1.2,
            'urgent': 1.5
        };
        
        // ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®çŠ¶æ…‹ç®¡ç†
        const chatState = {
            currentStep: 'greeting',
            estimateData: {
                region: '',
                area: 0,
                constructionType: '',
                businessType: '',
                kitchenScale: '',
                interiorGrade: '',
                specialFeatures: [],
                constructionPeriod: ''
            }
        };
        
        // DOMè¦ç´ ã®å–å¾—
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        sendButton.addEventListener('click', handleUserInput);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleUserInput();
            }
        });
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«æœ€åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
        window.addEventListener('load', startChat);
        
        // ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹ã™ã‚‹é–¢æ•°
        function startChat() {
            // åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            setTimeout(() => {
                addBotMessage('ã“ã‚“ã«ã¡ã¯ï¼é£²é£Ÿåº—å·¥äº‹ã®è¦‹ç©ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¸ã‚ˆã†ã“ãã€‚ç°¡å˜ãªè³ªå•ã«ç­”ãˆã¦ã„ãŸã ãã“ã¨ã§ã€ãŠãŠã‚ˆãã®å·¥äº‹è²»ç”¨ã‚’ãŠè¦‹ç©ã‚Šã—ã¾ã™ã€‚');
                
                setTimeout(() => {
                    addBotMessage('ã¾ãšã€å·¥äº‹äºˆå®šã®åœ°åŸŸã‚’æ•™ãˆã¦ãã ã•ã„ã€‚');
                    
                    // åœ°åŸŸé¸æŠè‚¢ã®è¡¨ç¤º
                    const regionOptions = [
                        { id: 'urban', text: 'éƒ½å¿ƒéƒ¨ï¼ˆæ±äº¬23åŒºã€å¤§é˜ªå¸‚ä¸­å¿ƒéƒ¨ãªã©ï¼‰' },
                        { id: 'major-city', text: 'ä¸»è¦éƒ½å¸‚ï¼ˆæ”¿ä»¤æŒ‡å®šéƒ½å¸‚ã®ä¸­å¿ƒéƒ¨ï¼‰' },
                        { id: 'regional-city', text: 'åœ°æ–¹éƒ½å¸‚ï¼ˆçœŒåºæ‰€åœ¨åœ°ãªã©ï¼‰' },
                        { id: 'suburban', text: 'éƒŠå¤–ãƒ»ãã®ä»–' }
                    ];
                    
                    addOptionsButtons(regionOptions, selectRegion);
                    
                }, 500);
            }, 500);
        }
        
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’å‡¦ç†ã™ã‚‹é–¢æ•°
        function handleUserInput() {
            const message = userInput.value.trim();
            if (message === '') return;
            
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¿½åŠ 
            addUserMessage(message);
            
            // å…¥åŠ›æ¬„ã‚’ã‚¯ãƒªã‚¢
            userInput.value = '';
            
            // ç¾åœ¨ã®ã‚¹ãƒ†ãƒƒãƒ—ã«å¿œã˜ã¦å‡¦ç†
            switch (chatState.currentStep) {
                case 'area':
                    processAreaInput(message);
                    break;
                    
                case 'restart':
                    if (message.includes('ã¯ã„') || message.includes('yes') || message.includes('ã‚‚ã†ä¸€åº¦')) {
                        resetChat();
                        startChat();
                    } else {
                        addBotMessage('ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚ä»–ã«ã”è³ªå•ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚');
                    }
                    break;
                    
                default:
                    // åŸºæœ¬çš„ã«ã¯ãƒœã‚¿ãƒ³ã§é¸æŠã™ã‚‹ã®ã§ã€ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã¯é™å®šçš„
                    addBotMessage('ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚é¸æŠè‚¢ã‹ã‚‰ãŠé¸ã³ãã ã•ã„ã€‚');
                    break;
            }
        }
        
        // ãƒœãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã™ã‚‹é–¢æ•°
        function addBotMessage(message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }
        
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã™ã‚‹é–¢æ•°
        function addUserMessage(message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user';
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }
        
        // é¸æŠè‚¢ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã™ã‚‹é–¢æ•°
        function addOptionsButtons(options, callback) {
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options clearfix';
            
            options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.textContent = option.text;
                button.addEventListener('click', () => {
                    // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
                    const buttons = optionsDiv.querySelectorAll('button');
                    buttons.forEach(btn => {
                        btn.disabled = true;
                        btn.style.opacity = '0.5';
                    });
                    
                    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é¸æŠã‚’è¡¨ç¤º
                    addUserMessage(option.text);
                    
                    // ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè¡Œ
                    callback(option.id);
                });
                
                optionsDiv.appendChild(button);
            });
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.appendChild(optionsDiv);
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }
        
        // åœ°åŸŸé¸æŠã®å‡¦ç†
        function selectRegion(regionId) {
            chatState.estimateData.region = regionId;
            
            setTimeout(() => {
                addBotMessage('åº—èˆ—ã®åºƒã•ã‚’æ•™ãˆã¦ãã ã•ã„ï¼ˆåªæ•°ï¼‰ã€‚10åªã€œ100åªã®ç¯„å›²ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                
                // é¢ç©å…¥åŠ›ã®æœ‰åŠ¹åŒ–
                userInput.disabled = false;
                sendButton.disabled = false;
                userInput.focus();
                
                chatState.currentStep = 'area';
            }, 500);
        }
        
        // é¢ç©å…¥åŠ›ã®å‡¦ç†
        function processAreaInput(input) {
            const area = parseFloat(input.replace(/[^0-9.]/g, ''));
            
            if (isNaN(area) || area < 10 || area > 100) {
                addBotMessage('10åªã€œ100åªã®ç¯„å›²ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ä¾‹: 30');
                return;
            }
            
            chatState.estimateData.area = area;
            userInput.disabled = true;
            sendButton.disabled = true;
            
            setTimeout(() => {
                addBotMessage('å·¥äº‹ã®ç¨®é¡ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                
                const constructionOptions = [
                    { id: 'new', text: 'æ–°è£…å·¥äº‹ï¼ˆã‚¹ã‚±ãƒ«ãƒˆãƒ³æ¸¡ã—ï¼‰' },
                    { id: 'renovation', text: 'ãƒªãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³å·¥äº‹ï¼ˆæ—¢å­˜åº—èˆ—ã®æ”¹è£…ï¼‰' },
                    { id: 'tenant', text: 'å±…æŠœãç‰©ä»¶æ´»ç”¨ï¼ˆæ—¢å­˜è¨­å‚™ã®æµç”¨ï¼‰' }
                ];
                
                addOptionsButtons(constructionOptions, selectConstructionType);
            }, 500);
        }
        
        // å·¥äº‹ç¨®é¡é¸æŠã®å‡¦ç†
        function selectConstructionType(constructionTypeId) {
            chatState.estimateData.constructionType = constructionTypeId;
            
            setTimeout(() => {
                addBotMessage('åº—èˆ—ã®æ¥­æ…‹ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                
                const businessOptions = [
                    { id: 'restaurant', text: 'ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ï¼ˆãƒ•ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ï¼‰' },
                    { id: 'cafe', text: 'ã‚«ãƒ•ã‚§' },
                    { id: 'bar', text: 'ãƒãƒ¼ãƒ»å±…é…’å±‹' },
                    { id: 'fastfood', text: 'ãƒ•ã‚¡ã‚¹ãƒˆãƒ•ãƒ¼ãƒ‰' },
                    { id: 'takeout', text: 'ãƒ†ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆå°‚é–€åº—' }
                ];
                
                addOptionsButtons(businessOptions, selectBusinessType);
            }, 500);
        }
        
        // æ¥­æ…‹é¸æŠã®å‡¦ç†
        function selectBusinessType(businessTypeId) {
            chatState.estimateData.businessType = businessTypeId;
            
            setTimeout(() => {
                addBotMessage('å¨æˆ¿ã®è¦æ¨¡ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                
                const kitchenOptions = [
                    { id: 'full', text: 'ãƒ•ãƒ«å¨æˆ¿ï¼ˆæœ¬æ ¼èª¿ç†ï¼‰' },
                    { id: 'semi', text: 'ã‚»ãƒŸã‚ªãƒ¼ãƒ—ãƒ³ã‚­ãƒƒãƒãƒ³' },
                    { id: 'simple', text: 'ç°¡æ˜“å¨æˆ¿ï¼ˆè»½èª¿ç†ã®ã¿ï¼‰' },
                    { id: 'drink', text: 'ãƒ‰ãƒªãƒ³ã‚¯èª¿ç†ã®ã¿' }
                ];
                
                addOptionsButtons(kitchenOptions, selectKitchenScale);
            }, 500);
        }
        
        // å¨æˆ¿è¦æ¨¡é¸æŠã®å‡¦ç†
        function selectKitchenScale(kitchenScaleId) {
            chatState.estimateData.kitchenScale = kitchenScaleId;
            
            setTimeout(() => {
                addBotMessage('å†…è£…ã®ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                
                const interiorOptions = [
                    { id: 'standard', text: 'ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ï¼ˆä¸€èˆ¬çš„ãªå†…è£…ï¼‰' },
                    { id: 'middle', text: 'ãƒŸãƒ‰ãƒ«ï¼ˆãƒ‡ã‚¶ã‚¤ãƒ³æ€§ã‚’æ„è­˜ï¼‰' },
                    { id: 'high', text: 'ãƒã‚¤ã‚°ãƒ¬ãƒ¼ãƒ‰ï¼ˆé«˜ç´šæ„Ÿã®ã‚ã‚‹ä»•ä¸Šã’ï¼‰' }
                ];
                
                addOptionsButtons(interiorOptions, selectInteriorGrade);
            }, 500);
        }
        
        // å†…è£…ã‚°ãƒ¬ãƒ¼ãƒ‰é¸æŠã®å‡¦ç†
        function selectInteriorGrade(interiorGradeId) {
            chatState.estimateData.interiorGrade = interiorGradeId;
            
            setTimeout(() => {
                addBotMessage('å¸Œæœ›ã™ã‚‹å·¥æœŸã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                
                const periodOptions = [
                    { id: 'normal', text: 'é€šå¸¸ï¼ˆ6ã€œ8é€±é–“ï¼‰' },
                    { id: 'express', text: 'æ€¥ãï¼ˆ4ã€œ6é€±é–“ã€å‰²å¢—æ–™é‡‘ï¼‰' },
                    { id: 'urgent', text: 'è¶…ç‰¹æ€¥ï¼ˆ2ã€œ4é€±é–“ã€å¤§å¹…å‰²å¢—ï¼‰' }
                ];
                
                addOptionsButtons(periodOptions, selectConstructionPeriod);
            }, 500);
        }
        
        // å·¥æœŸé¸æŠã®å‡¦ç†
        function selectConstructionPeriod(periodId) {
            chatState.estimateData.constructionPeriod = periodId;
            
            setTimeout(() => {
                addBotMessage('ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚å…¥åŠ›ã•ã‚ŒãŸæƒ…å ±ã‚’åŸºã«è¦‹ç©ã‚Šã‚’è¨ˆç®—ã—ã¦ã„ã¾ã™...');
                
                setTimeout(() => {
                    // è¦‹ç©ã‚Šè¨ˆç®—ã¨è¡¨ç¤º
                    calculateAndShowEstimate();
                }, 1000);
            }, 500);
        }
        
        // è¦‹ç©ã‚Šã®è¨ˆç®—ã¨è¡¨ç¤º
        function calculateAndShowEstimate() {
            const { region, area, constructionType, businessType, kitchenScale, interiorGrade, constructionPeriod } = chatState.estimateData;
            
            // åŸºæœ¬å·¥äº‹è²»ã®è¨ˆç®—
            const baseUnitPrice = baseCosts[region][constructionType]; // åªå˜ä¾¡ï¼ˆä¸‡å††ï¼‰
            const businessFactor = businessTypeFactors[businessType];
            const kitchenFactor = kitchenScaleFactors[kitchenScale];
            const interiorFactor = interiorGradeFactors[interiorGrade];
            
            let baseCost = area * baseUnitPrice * businessFactor * kitchenFactor * interiorFactor;
            
            // å¨æˆ¿è¨­å‚™ã‚³ã‚¹ãƒˆ
            let kitchenEquipmentCost = 0;
            if (kitchenScale === 'full') {
                kitchenEquipmentCost = area * 10; // åªã‚ãŸã‚Š10ä¸‡å††
            } else if (kitchenScale === 'semi') {
                kitchenEquipmentCost = area * 7; // åªã‚ãŸã‚Š7ä¸‡å††
            } else if (kitchenScale === 'simple') {
                kitchenEquipmentCost = area * 4; // åªã‚ãŸã‚Š4ä¸‡å††
            } else if (kitchenScale === 'drink') {
                kitchenEquipmentCost = area * 2; // åªã‚ãŸã‚Š2ä¸‡å††
            }
            
            // å±…æŠœãç‰©ä»¶ã®å ´åˆã¯å¨æˆ¿è¨­å‚™è²»ã‚’å‰Šæ¸›
            if (constructionType === 'tenant') {
                kitchenEquipmentCost *= 0.3; // 70%å‰Šæ¸›
            }
            
            // å·¥æœŸä¿‚æ•°ã®é©ç”¨
            const periodFactor = constructionPeriodFactors[constructionPeriod];
            const periodAdjustment = baseCost * (periodFactor - 1);
            
            // ç·å·¥äº‹è²»ï¼ˆç¨æŠœï¼‰
            const totalCost = baseCost + kitchenEquipmentCost + periodAdjustment;
            
            // ç¨è¾¼ç·é¡ï¼ˆ10%ï¼‰
            const totalCostWithTax = totalCost * 1.1;
            
            // åªå˜ä¾¡
            const tsuboCost = totalCost / area;
            
            // å·¥æœŸç›®å®‰
            let constructionPeriodEstimate = '';
            if (constructionPeriod === 'normal') {
                constructionPeriodEstimate = '6ã€œ8é€±é–“';
            } else if (constructionPeriod === 'express') {
                constructionPeriodEstimate = '4ã€œ6é€±é–“';
            } else if (constructionPeriod === 'urgent') {
                constructionPeriodEstimate = '2ã€œ4é€±é–“';
            }
            
            // è¦‹ç©ã‚Šçµæœã®è¡¨ç¤º
            const estimateResultDiv = document.createElement('div');
            estimateResultDiv.className = 'estimate-result';
            
            // è¦‹ç©ã‚Šã‚¿ã‚¤ãƒˆãƒ«
            const titleDiv = document.createElement('div');
            titleDiv.className = 'estimate-title';
            titleDiv.textContent = 'é£²é£Ÿåº—å·¥äº‹ ãŠè¦‹ç©ã‚Šçµæœ';
            estimateResultDiv.appendChild(titleDiv);
            
            // ç·é¡
            const priceDiv = document.createElement('div');
            priceDiv.className = 'estimate-price';
            priceDiv.textContent = `${Math.round(totalCost)}ä¸‡å††ï¼ˆç¨æŠœï¼‰`;
            estimateResultDiv.appendChild(priceDiv);
            
            // ç¨è¾¼é‡‘é¡
            const taxDiv = document.createElement('div');
            taxDiv.className = 'estimate-detail';
            taxDiv.innerHTML = `<span>ç¨è¾¼ç·é¡</span><span>${Math.round(totalCostWithTax)}ä¸‡å††</span>`;
            estimateResultDiv.appendChild(taxDiv);
            
            // åªå˜ä¾¡
            const tsuboDiv = document.createElement('div');
            tsuboDiv.className = 'estimate-detail';
            tsuboDiv.innerHTML = `<span>åªå˜ä¾¡</span><span>${Math.round(tsuboCost)}ä¸‡å††/åª</span>`;
            estimateResultDiv.appendChild(tsuboDiv);
            
            // åŸºæœ¬å·¥äº‹è²»
            const baseDiv = document.createElement('div');
            baseDiv.className = 'estimate-detail';
            baseDiv.innerHTML = `<span>åŸºæœ¬å·¥äº‹è²»</span><span>${Math.round(baseCost)}ä¸‡å††</span>`;
            estimateResultDiv.appendChild(baseDiv);
            
            // å¨æˆ¿è¨­å‚™è²»
            const kitchenDiv = document.createElement('div');
            kitchenDiv.className = 'estimate-detail';
            kitchenDiv.innerHTML = `<span>å¨æˆ¿è¨­å‚™è²»</span><span>${Math.round(kitchenEquipmentCost)}ä¸‡å††</span>`;
            estimateResultDiv.appendChild(kitchenDiv);
            
            // å·¥æœŸèª¿æ•´è²»
            if (periodAdjustment > 0) {
                const periodDiv = document.createElement('div');
                periodDiv.className = 'estimate-detail';
                periodDiv.innerHTML = `<span>å·¥æœŸèª¿æ•´è²»</span><span>${Math.round(periodAdjustment)}ä¸‡å††</span>`;
                estimateResultDiv.appendChild(periodDiv);
            }
            
            // å·¥æœŸç›®å®‰
            const periodEstDiv = document.createElement('div');
            periodEstDiv.className = 'estimate-detail';
            periodEstDiv.innerHTML = `<span>å·¥æœŸç›®å®‰</span><span>${constructionPeriodEstimate}</span>`;
            estimateResultDiv.appendChild(periodEstDiv);
            
            // æ³¨æ„æ›¸ã
            const noteDiv = document.createElement('div');
            noteDiv.className = 'estimate-note';
            noteDiv.textContent = 'â€» ã“ã®è¦‹ç©ã‚Šã¯æ¦‚ç®—ã§ã™ã€‚æ­£ç¢ºãªé‡‘é¡ã¯ç¾åœ°èª¿æŸ»å¾Œã«ç®—å‡ºã•ã‚Œã¾ã™ã€‚';
            estimateResultDiv.appendChild(noteDiv);
            
            // åœ°åŸŸç‰¹æœ‰ã®æ³¨æ„ç‚¹
            if (region === 'urban') {
                const urbanNoteDiv = document.createElement('div');
                urbanNoteDiv.className = 'estimate-note';
                urbanNoteDiv.textContent = 'â€» éƒ½å¿ƒéƒ¨ã§ã¯æ¬å…¥åˆ¶é™ã‚„é§è»Šè¦åˆ¶ã«ã‚ˆã‚Šã€è¿½åŠ è²»ç”¨ãŒç™ºç”Ÿã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚';
                estimateResultDiv.appendChild(urbanNoteDiv);
            }
            
            // ã‚„ã‚Šç›´ã—ãƒœã‚¿ãƒ³
            const restartDiv = document.createElement('div');
            restartDiv.className = 'clearfix';
            const restartButton = document.createElement('button');
            restartButton.className = 'restart-button';
            restartButton.textContent = 'ã‚‚ã†ä¸€åº¦è¨ˆç®—ã™ã‚‹';
            restartButton.addEventListener('click', () => {
                resetChat();
                startChat();
            });
            restartDiv.appendChild(restartButton);
            estimateResultDiv.appendChild(restartDiv);
            
            // çµæœã®è¿½åŠ 
            chatMessages.appendChild(estimateResultDiv);
            scrollToBottom();
            
            setTimeout(() => {
                addBotMessage('ãŠè¦‹ç©ã‚Šã‚’ç¢ºèªã„ãŸã ã‘ã¾ã—ãŸã‹ï¼Ÿã‚ˆã‚Šè©³ç´°ãªãŠè¦‹ç©ã‚Šã‚„å®Ÿéš›ã®ã”ç›¸è«‡ã¯ã€ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ ã‚ˆã‚ŠãŠæ°—è»½ã«ã”é€£çµ¡ãã ã•ã„ã€‚');
                
                chatState.currentStep = 'restart';
                userInput.disabled = false;
                sendButton.disabled = false;
            }, 1000);
        }
        
        // ãƒãƒ£ãƒƒãƒˆã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹é–¢æ•°
        function resetChat() {
            // ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢
            chatMessages.innerHTML = '';
            
            // çŠ¶æ…‹ã®ãƒªã‚»ãƒƒãƒˆ
            chatState.currentStep = 'greeting';
            chatState.estimateData = {
                region: '',
                area: 0,
                constructionType: '',
                businessType: '',
                kitchenScale: '',
                interiorGrade: '',
                specialFeatures: [],
                constructionPeriod: ''
            };
            
            // å…¥åŠ›æ¬„ã®ç„¡åŠ¹åŒ–
            userInput.disabled = true;
            sendButton.disabled = true;
        }
        
        // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ€ä¸‹éƒ¨ã«ç§»å‹•ã™ã‚‹é–¢æ•°
        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
    </script>
</body>
</html>
